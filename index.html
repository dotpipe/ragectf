<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTF Chess</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div id="game-container">
        <h1>CTF Chess</h1>
        <div id="score-display">
            <span>White: <span id="white-score">0</span></span>
            <span>Black: <span id="black-score">0</span></span>
        </div>
        <table id="chessboard"></table>
        <div id="controls">
            <button id="start-game">Start Game</button>
            <button id="reset-game">Reset Game</button>
        </div>
    </div>

    <script src="chess.js"></script>
    <script src="ctfai.js"></script>
    
    <script>
        const game = new CTFChess();
        const ai = new CTFAI(game, 'Black');
        let selectedPiece = null;
        let movingTo = null;
        let domSelectedPiece = null;
        function handleCellClick(event) {
            const row = parseInt(event.target.dataset.row);
            const col = parseInt(event.target.dataset.col);
            if (selectedPiece === null) {
                selectedPiece = { row, col };
                domSelectedPiece = document.querySelector(`[data-row="${row}"][data-col="${col}"]`);
                domSelectedPiece.classList.toggle('active');
            } else if (movingTo === null) {
                movingTo = { row, col };
            }
            else {
                game.makeMove(selectedPiece, movingTo);
                game.print_board();
                updateScoreDisplay();
                selectedPiece = null;
                movingTo = null;
                domSelectedPiece.classList.toggle('active');
                if (game.currentPlayer === 'Black') {
                    setTimeout(() => {
                        ai.makeMove();
                        game.print_board();
                        updateScoreDisplay();
                    }, 500);
                }
            }
        }

        function updateScoreDisplay() {
            document.getElementById('white-score').textContent = game.score.White;
            document.getElementById('black-score').textContent = game.score.Black;
        }

        document.getElementById('start-game').addEventListener('click', () => {
            game.resetGame();
            game.print_board();
            updateScoreDisplay();
        });

        document.getElementById('reset-game').addEventListener('click', () => {
            game.resetGame();
            game.print_board();
            updateScoreDisplay();
        });

    </script>
</body>

</html>